apiVersion: 1
groups:
  - orgId: 1
    name: 1m
    folder: Aggregator
    interval: 1m
    rules:
      - uid: d7f77f84-aefb-4496-afab-068b8c2b940a
        title: Cache misses high
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 900
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: increase(aggregator_cache_hitmiss_count{environment="ps2", result="cache_miss"}[$__rate_interval])
              interval: ""
              intervalMs: 15000
              legendFormat: '{{type}}'
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: [ ]
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 50
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 48
        noDataState: NoData
        execErrState: Error
        for: 5m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "48"
        labels:
          app: aggregator
        isPaused: false
      - uid: f071a63a-abe9-42fb-9ccf-04038327ca1d
        title: Unknown facilities / items
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: aggregator_cache_gauge{type=~"unknown_facilities|unknown_items"}
              interval: ""
              intervalMs: 15000
              legendFormat: '{{type}}'
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: [ ]
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 40
        noDataState: OK
        execErrState: Error
        for: 5m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "40"
        labels:
          app: aggregator
        isPaused: false
      - uid: c926f03d-77aa-4fa2-8dca-a2dd4e0b1f3b
        title: Failed messages by types
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 60
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(type, event_type) (increase(aggregator_queue_messages_count{environment="ps2", type!~"instance_mismatch|success"}[$__rate_interval]))
              interval: ""
              intervalMs: 15000
              legendFormat: '{{type}}: {{event_type}}'
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 60
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: [ ]
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            relativeTimeRange:
              from: 60
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 10
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 49
        noDataState: NoData
        execErrState: Error
        for: 5m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "49"
        isPaused: false
      - uid: fd208eea-0f69-4dc3-b2fc-16dcf5a41703
        title: Event Type processing time
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: histogram_quantile(0.95, sum by(le, eventType) (rate(aggregator_event_processing_histogram_bucket{environment="ps2"}[$__rate_interval])))
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 2
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 12
        noDataState: OK
        execErrState: Error
        for: 5m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "12"
        labels:
          app: aggregator
        isPaused: false
      - uid: ae88a6bc-647a-4383-b406-dc6d48d756b3
        title: No active alerts for 2 hours
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 10800
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(type) (aggregator_instances_gauge{type="active"})
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 10800
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              type: reduce
          - refId: C
            relativeTimeRange:
              from: 10800
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 1
                    type: lt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 26
        noDataState: NoData
        execErrState: Error
        for: 2h
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "26"
        labels:
          app: aggregator
        isPaused: false
      - uid: d0e9a95f-3a93-4e84-aadc-e9df4f2385b6
        title: Active Alerts - Overdue
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 10800
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(type) (aggregator_instances_gauge{type="overdue"})
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 10800
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              type: reduce
          - refId: C
            relativeTimeRange:
              from: 10800
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 26
        noDataState: NoData
        execErrState: Error
        for: 5m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "26"
        labels:
          app: aggregator
        isPaused: false
      - uid: cdf3d874-5309-48d6-881b-4315e60348b6
        title: Fail messages - discards high
        condition: D
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(type) (increase(aggregator_queue_messages_count{type="discard"}[$__rate_interval]))
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              type: reduce
          - refId: D
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 2
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - D
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: D
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 24
        noDataState: OK
        execErrState: Error
        for: 2m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "24"
        labels:
          app: aggregator
        isPaused: false
      - uid: ba3239f4-aaae-4674-aeca-318153228d63
        title: PS2Alerts API roundtimes
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 900
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: histogram_quantile(0.99, sum by(le, endpoint) (rate(aggregator_external_requests_histogram_bucket{provider="ps2alerts_api"}[$__rate_interval])))
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0.25
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 33
        noDataState: OK
        execErrState: Error
        for: 1m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "33"
        labels:
          app: aggregator
        isPaused: false
      - uid: b1a238ae-688a-41d7-8c28-caae0edddd4c
        title: External endpoint unsuccessful requests
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 900
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              exemplar: false
              expr: sum by(result, provider) (increase(aggregator_external_requests_count{environment="ps2", result=~"error"}[$__rate_interval]))
              hide: false
              instant: false
              interval: ""
              intervalMs: 15000
              legendFormat: '{{provider}}: {{result}}'
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 900
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            relativeTimeRange:
              from: 900
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 5
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 32
        noDataState: OK
        execErrState: Error
        for: 2m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "32"
        labels:
          app: aggregator
        isPaused: false
      - uid: b5349715-3b1f-4c22-8df7-86a6d2fb7648
        title: Census errors / retries
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(result) (increase(aggregator_external_requests_count{environment="ps2", result=~"error|retry", provider="census"}[$__rate_interval]))
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 28
        noDataState: OK
        execErrState: Error
        for: 2m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "28"
        labels:
          app: aggregator
        isPaused: false
      - uid: a6c64449-7a04-4f68-8b38-3f4dfbee23d3
        title: PS2Alerts API errors / retries
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(result) (increase(aggregator_external_requests_count{environment="ps2", result=~"error|retry", provider="ps2alerts_api"}[$__rate_interval]))
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 34
        noDataState: OK
        execErrState: Error
        for: 2m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "34"
        labels:
          app: aggregator
        isPaused: false
      - uid: a3112b87-9361-4594-bfcb-5be1e92bc713
        title: Census endpoint roundtimes
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: histogram_quantile(0.99, sum by(le, endpoint) (rate(aggregator_external_requests_histogram_bucket{environment="ps2", provider="census"}[$__rate_interval]))) / 4
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              settings:
                mode: dropNN
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 1
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 20
        noDataState: OK
        execErrState: Error
        for: 5m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "20"
        labels:
          app: aggregator
        isPaused: false
      - uid: baf4eff1-e896-4ea9-a9cb-ea4de4d23c11
        title: Broker cache rates
        condition: thresholds
        data:
          - refId: A
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum(rate(aggregator_broker_count{environment="ps2", result="cache_hit", broker="character"}[$__rate_interval]))
              hide: false
              interval: ""
              intervalMs: 15000
              legendFormat: '{{broker}}: {{result}}'
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum(rate(aggregator_broker_count{environment="ps2", result="cache_miss", broker="character"}[$__rate_interval]))
              hide: false
              interval: ""
              intervalMs: 15000
              legendFormat: '{{broker}}: {{result}}'
              maxDataPoints: 43200
              range: true
              refId: B
          - refId: D
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum(rate(aggregator_broker_count{environment="ps2", result="cache_hit", broker="item"}[$__rate_interval]))
              hide: false
              interval: ""
              intervalMs: 15000
              legendFormat: '{{broker}}: {{result}}'
              maxDataPoints: 43200
              range: true
              refId: D
          - refId: E
            relativeTimeRange:
              from: 21600
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum(rate(aggregator_broker_count{environment="ps2", result="cache_miss", broker="item"}[$__rate_interval]))
              hide: false
              interval: ""
              intervalMs: 15000
              legendFormat: '{{broker}}: {{result}}'
              maxDataPoints: 43200
              range: true
              refId: E
          - refId: character
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: __expr__
            model:
              datasource:
                name: Expression
                type: __expr__
                uid: __expr__
              expression: $A/($A+$B)*100
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: character
              type: math
              window: ""
          - refId: item
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: __expr__
            model:
              datasource:
                name: Expression
                type: __expr__
                uid: __expr__
              expression: $D/($D+$E)*100
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: item
              type: math
              window: ""
          - refId: char_rate
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params: []
                  reducer:
                    params: []
                    type: avg
                  type: query
              datasource:
                name: Expression
                type: __expr__
                uid: __expr__
              expression: character
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: char_rate
              settings:
                mode: dropNN
              type: reduce
          - refId: item_rate
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params: []
                  reducer:
                    params: []
                    type: avg
                  type: query
              datasource:
                name: Expression
                type: __expr__
                uid: __expr__
              expression: item
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: item_rate
              settings:
                mode: dropNN
              type: reduce
          - refId: thresholds
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 0
                      - 0
                    type: gt
                  operator:
                    type: and
                  query:
                    params: []
                  reducer:
                    params: []
                    type: avg
                  type: query
              datasource:
                name: Expression
                type: __expr__
                uid: __expr__
              expression: $char_rate < 80 || $item_rate < 80
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: thresholds
              type: math
        dashboardUid: 1v3LFaP4z
        panelId: 35
        noDataState: OK
        execErrState: Error
        for: 10m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "35"
        labels:
          app: aggregator
        isPaused: false
      - uid: c6250ba0-9543-41f6-9a34-6255d5c4f6ab
        title: Aggregators online
        condition: C
        data:
          - refId: A
            relativeTimeRange:
              from: 1800
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              datasource:
                type: prometheus
                uid: PBFA97CFB590B2093
              editorMode: builder
              expr: sum by(instance) (up{job="ps2alerts_aggregator"})
              interval: ""
              intervalMs: 15000
              legendFormat: __auto
              maxDataPoints: 43200
              range: true
              refId: A
          - refId: B
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params: []
                    type: gt
                  operator:
                    type: and
                  query:
                    params:
                      - B
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: A
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              reducer: last
              refId: B
              type: reduce
          - refId: C
            datasourceUid: __expr__
            model:
              conditions:
                - evaluator:
                    params:
                      - 1
                    type: lt
                  operator:
                    type: and
                  query:
                    params:
                      - C
                  reducer:
                    params: []
                    type: last
                  type: query
              datasource:
                type: __expr__
                uid: __expr__
              expression: B
              hide: false
              intervalMs: 1000
              maxDataPoints: 43200
              refId: C
              type: threshold
        dashboardUid: 1v3LFaP4z
        panelId: 46
        noDataState: NoData
        execErrState: Error
        for: 2m
        annotations:
          __dashboardUid__: 1v3LFaP4z
          __panelId__: "46"
        isPaused: false
